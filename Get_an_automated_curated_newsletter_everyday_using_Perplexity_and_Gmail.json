{
  "id": "3H9yJlSwjn8E3KpP",
  "meta": {
    "instanceId": "7b22476bf9699de09fe66fed92056e8ae798418cc9901fa9bd85bb46439116b8",
    "templateId": "4412",
    "templateCredsSetupCompleted": true
  },
  "name": "Perplexity Newsletter",
  "tags": [],
  "nodes": [
    {
      "id": "a808eaa1-744e-4a01-98d8-d96428346d11",
      "name": "Daily Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [
        360,
        640
      ],
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 8
            }
          ]
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "e4e02799-c6e2-44ce-8015-5fd71ef9a848",
      "name": "Workflow Documentation",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        180,
        200
      ],
      "parameters": {
        "color": 6,
        "width": 350,
        "height": 400,
        "content": "## Perplexity Newsletter Workflow\nThis workflow runs every day at 9 AM to:\n\nFetch Curated News: Uses Perplexity to gather the latest updates in three domains:\n🎓 MBA News (admissions, trends, opportunities)\n🛠️ Product Management (roles, skills, industry shifts)\n🤖 AI Automation (tools, breakthroughs, job market)\n\nFormat Newsletter: Combines all news into a single, beautifully formatted HTML email with clear section headers and clickable links.\n\nSend to Gmail Drafts: Saves the newsletter as a draft in your Gmail account, ready for review or sending.\nSetup Required:\nPerplexity (or OpenAI) API credentials\nGmail account connected to n8n\nUpdate recipient email address in Gmail node'\n\nCustomization:\nChange schedule time in the Cron node\nModify news topics or prompts in the Perplexity nodes\nAdjust section titles or email styling in the Format Newsletter (Code) node"
      },
      "typeVersion": 1
    },
    {
      "id": "dd06d61f-a4bd-4813-9586-d690e0177dc8",
      "name": "Setup Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1020,
        280
      ],
      "parameters": {
        "color": 3,
        "width": 300,
        "height": 260,
        "content": "⚙️ **Configuration Needed:**\n\n1. **Perplexity API**: Add your Perplexity API key.\n\n2. **Email Settings**: \n   - Update SMTP credentials in \"email-credentials\"\n   - Change recipient email in \"Send Email Summary\" node\n   - Update sender email if needed\n\n3. **Timing**: Modify schedule in \"Daily Trigger\" if you want different timing\n\n4. **Content**: Customize the news categories or add more in the Perplexity prompt"
      },
      "typeVersion": 1
    },
    {
      "id": "492432d5-3c18-4517-85b9-4407c4ed26a3",
      "name": "Gmail",
      "type": "n8n-nodes-base.gmail",
      "position": [
        1500,
        640
      ],
      "webhookId": "6e5776e8-b6b9-4c56-8b3a-812f68959433",
      "parameters": {
        "sendTo": "v.abhijay@gmail.com",
        "message": "={{ $json.message }}",
        "options": {},
        "subject": "=Aspyre Community Content"
      },
      "credentials": {
        "gmailOAuth2": {
          "id": "nl3SKVasBIyYDr5a",
          "name": "Gmail account"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "db433d7c-e212-4c9b-91d9-195df9ac0a95",
      "name": "Set Dates",
      "type": "n8n-nodes-base.set",
      "position": [
        600,
        640
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "current-date",
              "name": "currentDate",
              "type": "string",
              "value": "={{ $now.format('yyyy-MM-dd') }}"
            },
            {
              "id": "yesterday-date",
              "name": "lastweekDate",
              "type": "string",
              "value": "={{ $now.minus({days: 7}).format('yyyy-MM-dd') }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "73311be6-834f-4065-9018-7e3d73e11c5a",
      "name": "MBA News",
      "type": "n8n-nodes-base.perplexity",
      "position": [
        840,
        440
      ],
      "parameters": {
        "model": "sonar",
        "options": {},
        "messages": {
          "message": [
            {
              "role": "system",
              "content": "You're an expert content curator for an international student community applying for MBA programs abroad. Your job is to find a recent, high-quality news link that directly helps students make better decisions about applying. Prioritize articles about:\n\nMBA rankings or business school reputation\n\nScholarships, fellowships, or financial aid\n\nVisa or work authorization updates\n\nYour tone should be natural and human — write 1–2 lines of insight or commentary as if you're Abhijay Arora, an HBS grad helping others navigate this journey. Be thoughtful, sharp, and slightly provocative. Don’t explain. Don’t summarize. Just react like you would in a WhatsApp group.\n\nOutput format:\n\n\n[Headline or title]  \n[URL]  \n[1–2 lines of Abhijay's commentary]"
            },
            {
              "content": "=Give me 1 relevant link published between {{ $json.currentDate }} and {{ $json.lastweekDate }} for Indian students applying to MBA programs abroad this year, with a short, thought-provoking, concise commentary."
            }
          ]
        },
        "simplify": true,
        "requestOptions": {}
      },
      "credentials": {
        "perplexityApi": {
          "id": "5nXSmnOqfBNdG3Qo",
          "name": "Perplexity account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "50d29156-abfb-47cd-ab76-1c053d64cd28",
      "name": "Product Management",
      "type": "n8n-nodes-base.perplexity",
      "position": [
        840,
        640
      ],
      "parameters": {
        "model": "sonar",
        "options": {},
        "messages": {
          "message": [
            {
              "role": "system",
              "content": "You track new product releases and product management job trends. Your job is to surface one recent link that would interest someone trying to break into product management or stay sharp as a PM. Focus on:\n\nA major tech product or feature launch\n\nA newly listed PM job or hiring signal\n\nProduct strategy discussions or shifts\n\nAfter sharing the link, write a smart, brief reaction (1–2 lines) like a PM would — ideally something that could spark debate or reflection. Use the voice of Abhijay Arora: product-savvy, no fluff, connects the dots.\n\nOutput format:\n\n[Headline or title]  \n[URL]  \n[1–2 lines of product thinking or reaction]"
            },
            {
              "content": "=Share 1 recent product launch or PM job link published between {{ $json.currentDate }} and {{ $json.lastweekDate }} with a smart one-liner commentary."
            }
          ]
        },
        "simplify": true,
        "requestOptions": {}
      },
      "credentials": {
        "perplexityApi": {
          "id": "5nXSmnOqfBNdG3Qo",
          "name": "Perplexity account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "10c040d0-70ed-443b-bd64-3ff44f88b820",
      "name": "AI Automation News",
      "type": "n8n-nodes-base.perplexity",
      "position": [
        840,
        820
      ],
      "parameters": {
        "model": "sonar",
        "options": {},
        "messages": {
          "message": [
            {
              "role": "system",
              "content": "You uncover practical ways professionals can use AI (especially agentic workflows) to work smarter. Find one recent article, video, or guide that shows:\n\nA useful AI tool to automate tasks\n\nA real workflow that saves time or improves job hunting\n\nA non-obvious productivity hack using AI\n\nWrite a crisp 1–2 line reaction in the voice of Abhijay Arora: strategic, curious, and practical. Make people want to try it, rethink their current process, or share it. No fluff. No generic takes.\n\nOutput format:\n\n\n\n[Title or description of the idea]  \n[URL]  \n[1–2 lines of commentary that provoke or teach]"
            },
            {
              "content": "=Find 1 link published between {{ $json.currentDate }} and {{ $json.lastweekDate }}  that shows a practical AI workflow to boost job productivity or improve job search, with a short reaction."
            }
          ]
        },
        "simplify": true,
        "requestOptions": {}
      },
      "credentials": {
        "perplexityApi": {
          "id": "5nXSmnOqfBNdG3Qo",
          "name": "Perplexity account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "800e6cda-ca99-4600-aad4-d293be6c8f3b",
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "position": [
        1100,
        640
      ],
      "parameters": {
        "numberInputs": 3
      },
      "typeVersion": 3.2
    },
    {
      "id": "767b2f00-757b-4c61-af1b-1a04d9a9a919",
      "name": "Combine messages",
      "type": "n8n-nodes-base.code",
      "position": [
        1280,
        640
      ],
      "parameters": {
        "jsCode": "// Define section titles in the order your items arrive\nconst sectionTitles = [\n  \"MBA News\",\n  \"Product Management\",\n  \"AI Automation News\"\n];\n\n// Combine and format each message with a section header\nconst formattedSections = items.map((item, idx) => {\n  const title = sectionTitles[idx] || `Section ${idx + 1}`;\n  const content = item.json.message || '';\n\n  // Apply your formatting, showing the actual URL as the link text\n  const formattedContent = content\n    .replace(/\\n/g, '<br>')\n    .replace(/## (.*?)<br>/g, '<h2 style=\"color: #2563eb; margin: 25px 0 15px 0; border-bottom: 2px solid #e5e7eb; padding-bottom: 8px;\">$1</h2>')\n    .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n    .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n    .replace(/- \\*\\*(.*?)\\*\\*:/g, '<div style=\"margin: 15px 0;\"><strong style=\"color: #1e40af;\">• $1:</strong>')\n    .replace(/\\[\\d+\\]/g, '') // Remove citation numbers for cleaner display\n    .replace(/(https?:\\/\\/[^\\s<]+)/g, '<a href=\"$1\" style=\"color: #2563eb; text-decoration: none;\">$1</a>');\n\n  return `\n    <section style=\"margin-bottom: 40px;\">\n      <h2 style=\"color: #2563eb; margin: 25px 0 15px 0; border-bottom: 2px solid #e5e7eb; padding-bottom: 8px;\">${title}</h2>\n      <div>${formattedContent}</div>\n    </section>\n  `;\n});\n\n// Combine all sections into a single message string\nreturn [{\n  json: {\n    message: formattedSections.join('')\n  }\n}];"
      },
      "typeVersion": 2
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "54b8123c-00a8-426f-bebd-ece98a63a6e8",
  "connections": {
    "Gmail": {
      "main": [
        []
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Combine messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MBA News": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Dates": {
      "main": [
        [
          {
            "node": "MBA News",
            "type": "main",
            "index": 0
          },
          {
            "node": "Product Management",
            "type": "main",
            "index": 0
          },
          {
            "node": "AI Automation News",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Daily Trigger": {
      "main": [
        [
          {
            "node": "Set Dates",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Combine messages": {
      "main": [
        [
          {
            "node": "Gmail",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Automation News": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "Product Management": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    }
  }
}