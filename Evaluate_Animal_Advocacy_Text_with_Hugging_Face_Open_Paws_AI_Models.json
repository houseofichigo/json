{
  "id": "DTAMHkTadEbS2Xsv",
  "meta": {
    "instanceId": "26bd595441827fb23edb0643d6d240e79b0b8993d278e90950f16e18bf9e3c4a"
  },
  "name": "Scoring Text (Sub-Workflow)",
  "tags": [],
  "nodes": [
    {
      "id": "a81f2018-ff9d-473e-80d3-c0305b297a58",
      "name": "When Executed by Another Workflow",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "position": [
        -600,
        -20
      ],
      "parameters": {
        "workflowInputs": {
          "values": [
            {
              "name": "text"
            }
          ]
        }
      },
      "typeVersion": 1.1
    },
    {
      "id": "a857fd97-8a53-4988-8bf0-dd7425725ca1",
      "name": "Get Performance Score",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -340,
        -120
      ],
      "parameters": {
        "url": "INSERT_YOUR_ENDPOINT_URL_HERE",
        "method": "POST",
        "options": {},
        "jsonBody": "={\n  \"inputs\": {{ JSON.stringify($json.text) }},\n  \"parameters\": {}\n} ",
        "sendBody": true,
        "sendHeaders": true,
        "specifyBody": "json",
        "authentication": "predefinedCredentialType",
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            }
          ]
        },
        "nodeCredentialType": "huggingFaceApi"
      },
      "credentials": {
        "httpHeaderAuth": {
          "id": "obk2OV7pJHPdAiyg",
          "name": "Header Auth account"
        },
        "huggingFaceApi": {
          "id": "N2L9e0Csws9dfDOW",
          "name": "HuggingFaceApi account"
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "f4904bd1-bedb-46d9-84e3-4dcd11fbe7e1",
      "name": "Get Preference Score",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -340,
        80
      ],
      "parameters": {
        "url": "INSERT_YOUR_ENDPOINT_URL_HERE",
        "method": "POST",
        "options": {},
        "jsonBody": "={\n  \"inputs\": {{ JSON.stringify($json.text) }},\n  \"parameters\": {}\n} ",
        "sendBody": true,
        "sendHeaders": true,
        "specifyBody": "json",
        "authentication": "predefinedCredentialType",
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            }
          ]
        },
        "nodeCredentialType": "huggingFaceApi"
      },
      "credentials": {
        "huggingFaceApi": {
          "id": "N2L9e0Csws9dfDOW",
          "name": "HuggingFaceApi account"
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "33699ccd-31f2-4bca-81b8-ad00ca2263ba",
      "name": "Set Performance Score",
      "type": "n8n-nodes-base.set",
      "position": [
        -120,
        -120
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "1ba08ac6-99c3-4e2f-ba46-7f570fa35d10",
              "name": "performance_score",
              "type": "number",
              "value": "={{ $json.score }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "641838ba-ca68-4a0e-b9e0-9be37e4e8c32",
      "name": "Get Preference Score2",
      "type": "n8n-nodes-base.set",
      "position": [
        -120,
        80
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "1ba08ac6-99c3-4e2f-ba46-7f570fa35d10",
              "name": "preference_score",
              "type": "number",
              "value": "={{ $json.score }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "3e215fed-abd6-43c0-b736-deec0d97c5fe",
      "name": "Set Output",
      "type": "n8n-nodes-base.set",
      "position": [
        480,
        -20
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "e1f63dc1-ad98-4a18-97f7-9f6053201875",
              "name": "performance_score",
              "type": "number",
              "value": "={{ $json.data[0].performance_score }}"
            },
            {
              "id": "928054ae-545d-43a8-a017-44dcf2bef749",
              "name": "preference_score",
              "type": "number",
              "value": "={{ $json.data[1].preference_score }}"
            },
            {
              "id": "22adbb02-16f4-426d-a2da-c9c18e5fdefe",
              "name": "text",
              "type": "string",
              "value": "={{ $('When Executed by Another Workflow').item.json.text }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "5363b1e5-5045-4a8d-bade-f31e7b44c4b3",
      "name": "Merge Branches",
      "type": "n8n-nodes-base.merge",
      "position": [
        100,
        -20
      ],
      "parameters": {},
      "typeVersion": 3.2
    },
    {
      "id": "eda4c1b6-3c6a-4c00-8b35-d7a8ba3d3db9",
      "name": "Create Single Item",
      "type": "n8n-nodes-base.aggregate",
      "position": [
        280,
        -20
      ],
      "parameters": {
        "options": {},
        "aggregate": "aggregateAllItemData"
      },
      "typeVersion": 1
    },
    {
      "id": "92b8d2e1-ea97-404f-abcc-997158c4ad3d",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1260,
        -180
      ],
      "parameters": {
        "width": 560,
        "height": 460,
        "content": "## Sub-Workflow Setup: Text Scoring Models\n\nTo use the scoring sub-workflow, you’ll need to deploy two Hugging Face regression models as inference endpoints:\n\n1. [**Animal Advocate Preference Prediction (Longform)**](https://huggingface.co/open-paws/animal_advocate_preference_prediction_longform)  \n2. [**Text Performance Prediction (Longform)**](https://huggingface.co/open-paws/text_performance_prediction_longform)\n\n### Steps:\n\n1. Visit each model’s Hugging Face page.\n2. Click the **\"Deploy\"** button to create an **inference endpoint** for each model.\n3. Once deployed, copy the **Inference Endpoint URL** for each model.\n4. Add the URLs to the appropriate fields in the n8n sub-workflow where indicated and add your access token to the Hugging Face API credential type for the HTTP nodes.\n\n> ⚠️ Make sure your Hugging Face account has the necessary permissions to create inference endpoints and that your access token has API access enabled.\n"
      },
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "f7607f90-ee08-40f1-9565-0e6caca0c491",
  "connections": {
    "Merge Branches": {
      "main": [
        [
          {
            "node": "Create Single Item",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Single Item": {
      "main": [
        [
          {
            "node": "Set Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Preference Score": {
      "main": [
        [
          {
            "node": "Get Preference Score2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Performance Score": {
      "main": [
        [
          {
            "node": "Set Performance Score",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Preference Score2": {
      "main": [
        [
          {
            "node": "Merge Branches",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Set Performance Score": {
      "main": [
        [
          {
            "node": "Merge Branches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When Executed by Another Workflow": {
      "main": [
        [
          {
            "node": "Get Performance Score",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get Preference Score",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}